this is my changed utility function for version 2